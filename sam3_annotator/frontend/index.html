<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAM3 Web Annotator</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="editor-screen" class="screen active">
        <header>
            <div class="logo">SAM3 Annotator</div>

            <div class="toolbar"
                style="display: flex; gap: 10px; align-items: center; margin-left: 20px; flex-grow: 1;">
                <label>Work Dir:</label>
                <div
                    style="display: flex; border: 1px solid #cbd5e1; border-radius: 6px; overflow: hidden; background: #fff;">
                    <input type="text" id="workdir-input" class="modern-input"
                        value="/Users/harryzhang/git/tempopeak/datasets/serve"
                        style="width: 280px; border: none; border-radius: 0; outline: none; box-shadow: none;">
                    <button id="browse-btn" class="secondary-btn"
                        style="border: none; border-left: 1px solid #cbd5e1; border-radius: 0; background: #e2e8f0; cursor: pointer; padding: 0 10px;">Browse</button>
                </div>

                <div style="width: 15px;"></div>

                <label>FPS:</label>
                <input type="number" id="fps-input" value="30" class="modern-input" min="1" style="width: 60px;">

                <span id="loading-msg" style="margin-left: 10px; font-size: 0.9rem; color: #64748b;"></span>
            </div>

            <div class="actions" style="display: flex; gap: 8px;">
                <button id="save-overwrite-btn" class="primary-btn"
                    style="background-color: #10b981; border-color: #059669;">Save (Overwrite)</button>
                <button id="save-as-btn" class="secondary-btn">Save As... (Download)</button>
            </div>
        </header>

        <div class="workspace-wrapper">
            <!-- Top Half: 3 Columns -->
            <div class="top-half">
                <!-- Left Sidebar: Videos List -->
                <div class="sidebar left-sidebar" style="width: 200px; border-right: 1px solid #e2e8f0;">
                    <div class="sidebar-header">
                        <h3>Available Videos</h3>
                    </div>
                    <div class="video-list" id="video-list" style="overflow-y: auto; padding: 10px;">
                        <div style="color: #94a3b8; font-size: 0.85rem; padding: 10px;">Loading videos...</div>
                    </div>
                </div>

                <!-- Middle Area: Video Player -->
                <div class="center-view">
                    <div class="video-container" id="video-container">
                        <div class="video-wrapper">
                            <video id="video-player" muted playsinline></video>
                            <canvas id="mask-canvas"></canvas>
                            <canvas id="ui-canvas"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Right Panel: Objects List -->
                <div class="sidebar right-sidebar" style="width: 260px; border-left: 1px solid #e2e8f0;">
                    <div class="sidebar-header">
                        <h3>Objects in Frame <span id="current-frame-lbl">0</span></h3>
                    </div>
                    <div class="objects-list" id="objects-list">
                        <!-- Object cards generated by JS -->
                    </div>
                </div>
            </div>

            <!-- Bottom Half: Timeline Editor -->
            <div class="bottom-half">
                <div class="timeline-editor">
                    <button id="play-pause-btn" class="icon-btn">▶</button>
                    <button id="prev-btn" class="icon-btn">❮</button>
                    <button id="next-btn" class="icon-btn">❯</button>
                    <button id="calibrate-btn" class="icon-btn"
                        style="width: auto; padding: 0 8px; font-weight: bold; color: #ef4444; border-color: #ef4444;">强制命中校准
                        (Space)</button>
                    <div class="frame-counter">
                        Frame: <input type="number" id="frame-input" value="0" min="0">
                    </div>
                </div>

                <div class="timeline-tracks" id="timeline-tracks">
                    <!-- Playhead overlay -->
                    <div id="playhead"></div>

                    <!-- Tracks layout container -->
                    <div id="tracks-container">
                        <!-- Track rows generated by JS -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <script src="app.js?v=2"></script>
</body>

</html>